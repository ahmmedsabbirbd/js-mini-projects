<!DOCTYPE html>
<html>
<head>

  <!-- <!DOCTYPE html>
  <html>
  <head>
    <base target="_top">
  </head>
  <body>
    <center><br>
   <h2>Display google sheet data on webpage</h2>
   <table border="3" style="border:2px solid black" cellpadding="5px" >
    <?var tableData = getSheetData();?>
    <?for(var i = 0; i < tableData.length; i++) { ?>
      <?if(i == 0) { ?>
        <tr>
        <?for(var j = 0; j < tableData[i].length; j++) { ?>
        <th><?= tableData[i][j] ?></th>
        <? } ?>
        </tr>
      <? } else { ?>
        <tr>
        <?for(var j = 0; j < tableData[i].length; j++) { ?>
        <td><?= tableData[i][j] ?></td>
        <? } ?>
        </tr>
      <? } ?>
    <? } ?>
    </table></center>
  </body>
  </html> -->

  <!-- function doGet(e) {
      var x = HtmlService.createTemplateFromFile("");
      var y = x.evaluate();
      var z = y.setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
      return z;
    }

    function getSheetData()  { 
      var a= SpreadsheetApp.getActiveSpreadsheet();
      var b = a.getSheetByName('Sheet1'); 
      var c = b.getDataRange();
      return c.getValues();  
    } -->


    <!-- var sheetName = 'Sheet1'
    var scriptProp = PropertiesService.getScriptProperties()

    function intialSetup () {
      var activeSpreadsheet = SpreadsheetApp.getActiveSpreadsheet()
      scriptProp.setProperty('key', activeSpreadsheet.getId())
    }

    function doPost (e) {
      var lock = LockService.getScriptLock()
      lock.tryLock(10000)

      try {
        var doc = SpreadsheetApp.openById(scriptProp.getProperty('key'))
        var sheet = doc.getSheetByName(sheetName)

        var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0]
        var nextRow = sheet.getLastRow() + 1

        var newRow = headers.map(function(header) {
          return header === 'timestamp' ? new Date() : e.parameter[header]
        })

        sheet.getRange(nextRow, 1, 1, newRow.length).setValues([newRow])

        return ContentService
          .createTextOutput(JSON.stringify({ 'result': 'success', 'row': nextRow }))
          .setMimeType(ContentService.MimeType.JSON)
      }

      catch (e) {
        return ContentService
          .createTextOutput(JSON.stringify({ 'result': 'error', 'error': e }))
          .setMimeType(ContentService.MimeType.JSON)
      }

      finally {
        lock.releaseLock()
      }
    } -->

  <title>form to google sheet</title>
  <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
</head>

<body style="padding: 20px 50px;" oncontextmenu="return false">
<form method="POST" name="google-sheet">
    <div class="mb-3">
        <label for="name" class="form-label">Full Name</label>
        <input type="text" name="name" class="form-control" id="name" placeholder="">
    </div>

    <div class="mb-3">
        <label for="exampleFormControlInput1" class="form-label">Email address</label>
        <input type="email" class="form-control" name="email" id="exampleFormControlInput1" placeholder="name@example.com">
    </div>

    <div class="mb-3">
        <label for="exampleFormControlTextarea1" class="form-label">Example textarea</label>
        <textarea class="form-control" name="text" id="exampleFormControlTextarea1" rows="3"></textarea>
    </div>

    <input type="submit" name="submit">
</form>

  <div style="width: 100%; margin-top: 30px; height: 100%; "> 
    <iframe width="100%" height="500px" src="https://script.google.com/macros/s/AKfycbxayCXQfc3ljfhIxFCXfvM73yos40f__wH9hBFQT4ImVascVOyUtRuhMP9y3ZsmEHsT/exec"></iframe>
  <div>
  <!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>

<script type="text/javascript">
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzKibpavOlnZI2AxczIs-E5b9dMsOI0ZSMJr7G4zW_KOzPfSUVVa4OTQ0Dc5xZpAOg/exec'
            const form = document.forms['google-sheet']
          
            form.addEventListener('submit', e => {
              e.preventDefault()
              fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => alert("Thanks for Contacting us..! We Will Contact You Soon..."))
                .catch(error => console.error('Error!', error.message))
            })
</script>
</div>
</body>
</html>